# <center> 统计机器学习附加题

<center> by: Shinning Zhou

注：已征得任课老师同意。

______________________________________________________________________

2022春的统计机器学习一共有三场附加题，按照任务类型分别是：

1. 基于决策树的分类问题：借贷风险预测
2. 含时间序列，基于knn的回归问题：空气质量预测
3. 不限算法的文本分类问题：垃圾邮件识别

笔者在三场比赛中均为第二名（笑）。事实上如果稍微了解过数学建模或者机器学习的基本知识，对此有兴趣且肯花时间，拿到这个名次并不算太难（**比较难的是全都拿第二**）。

在此简单分享一下自己的模型、代码及研究思路，对每个问题的具体尝试和分数在文件夹的README里，也有（写的很烂但起码能跑的gpt）代码可参考，这里仅作为对数据挖掘竞赛的概述和思路拓展。

______________________________________________________________________

如果你认为这对你有帮助，欢迎给我的仓库一个star: https://github.com/Shinning-Zhou/HITSZ-OpenDS

如果你对此有困惑或质疑，欢迎联系我进行讨论或纠错：shinning_zhou@163.com

______________________________________________________________________

## 思路

拿到一个问题，首先想这个问题属于什么类型、应该用什么模型。附加题因为毕竟是课内的竞赛，前两场有限定的模型类型。笔者是严格遵循规则的，但是前三的同学中不乏用了一些变形金刚的选手。

接着无非特征工程和调参，或者一些工程上的小tricks。tricks笔者懂得不多，大部分是溯源数据集在kaggle上看comments。

笔者的思路一般是：

- EDA，看眼数据长啥样。
- 先用课内的模型调库试一下，一般都是不太高的。
- 接着调参多试几遍，一般也不能提高太多。
- 更换模型，找相关的模型（在比赛允许的范围内）。这个看知识的储备范围了，如果上到神经网络这个方面的，会有一些复杂。
- 特征工程。这个笔者真不太懂，几次比赛中特征工程的处理都不是很好，下面会给一些简单的可行的思路。
- 调参，分无头绪调参（哎，就是乱试），和暴力调参（遍历！），以及有技巧的调参（后面细说）。
- 如果还是不满意，再返回第三步进行循环，直到满意为止。如果实在找不到模型，也可以试试模型集成。

## 模型

### 第一次竞赛：基于决策树的分类模型

因为问了老师，说树相关的模型都可以，所以尝试了一些**树相关**的模型，包括：

- CART决策树，随机森林，gbdt(梯度提升决策树)，xgboost，catboost，lightgbm，SVM

也使用到了模型融合，尝试包括：

- 随机森林+xgboost+gbdt，xgboost+catboost+lightgbm+svm+随机森林。

### 第二次竞赛：基于KNN的分类模型

老师对模型范围定的很死，**只允许KNN相关**的。笔者有做一些其他的尝试，但提交的最高分数仍是使用KNN模型的，只是用到了其他方法进行处理。

前三名的其他选手均未严格遵循只使用knn的要求。

尝试的模型包括：

- RNN，LSTM，KNN

### 第三次竞赛：不限算法的文本分类问题

因为不限算法，且是文本分类这种典型的nlp问题，这个地方可以用到的算法就很多了。

尝试的模型包括：

- nnlm（tf），bert（pytorch）

这里如果有兴趣，大可以去多试几种，但是据我所知前三名全部都是bert。笔者时间不多（而且真的想拿一个第二名大满贯），所以试到BERT就停止了。

### 模型集成

因为附加题限制的模型范围较小，因此可以考虑模型集成，即将不同模型的预测结果融合起来进行预测。第一次竞赛是个很好的例子。笔者想到且用过的主要有：

- 基于投票法的模型集成。
- 基于神经网络的模型集成。

## 数据预处理&特征工程

对于附加题而言，能用到且有用的特征工程方法不算太多。笔者简单列几个用到的方法，如果想要详细了解的同学可以参考网上的介绍，比如：[深度了解特征工程 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/111296130)

笔者有用到的方法包括：

1. 数据标准化。注意将训练集和测试集一起标准化。

2. 深度特征合成。

3. 对不同的特征附权重。权重通过网格搜索遍历得出。

4. 对于nlp问题，可以多采用几种编码方法进行处理。

## 调参

1. 瞎调。随手改几个参数甚至是随机种子交一发。
2. 暴力调参。使用网格搜索或者贝叶斯搜索对超参数进行遍历。
3. 技巧性调参：推荐看模型作者的建议（尤其是上到transformer的），或者网上的调参经验。思考如下问题：
   1. 调哪些参数？

   2. 学习率？

   3. 将哪些参数分组调？

   4. 搜索范围？从大到小调。

      ——建议根据不同模型上网搜经验，搜个祖传参数开始调。

## 训练

由于部分模型训练量较大，需要使用GPU，而老师并未详细讲怎么寻找资源，在这里给出几个可以使用的GPU平台：

1. https://www.autodl.com/ 较为便宜且方便的GPU租用平台。
2. http://hpc.hitsz.edu.cn/ 学校的高性能计算云服务中心，免费，且有A100，缺点是要等。
